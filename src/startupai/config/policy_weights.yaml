# ============================================
# Policy Weights Configuration
# ============================================
# Configures the Weighted Bandit for policy selection (Area 3).
# Supports A/B testing between yaml_baseline and retrieval_v1 policies.
#
# The bandit uses Upper Confidence Bound (UCB) algorithm to balance
# exploration (trying less-tested policies) and exploitation (using
# policies with proven higher rewards).
# ============================================

# Global settings
global:
  # Minimum samples before including a policy in selection
  min_samples_for_selection: 10

  # Exploration bonus coefficient (higher = more exploration)
  exploration_bonus: 0.1

  # Default policy when insufficient data exists
  default_policy: yaml_baseline

  # Enable/disable bandit (use default_policy if disabled)
  bandit_enabled: true

# Policy definitions
policies:
  yaml_baseline:
    description: "Static YAML-defined experiment configurations"
    version: "1.0.0"
    # Prior weight (used until enough samples exist)
    prior_weight: 0.5
    # Primary metric used for reward calculation
    primary_metric: "conversion_rate"
    # Enabled for these experiment types
    enabled_for:
      - ad_creative
      - landing_page
      - interview_question
      - pricing_test

  retrieval_v1:
    description: "Retrieval-augmented configurations from Flywheel learnings"
    version: "1.0.0"
    prior_weight: 0.5
    primary_metric: "conversion_rate"
    enabled_for:
      - ad_creative
      - landing_page
      - interview_question
      - pricing_test

# Experiment type specific settings
experiment_types:
  ad_creative:
    # Primary metric for this experiment type
    primary_metric: "ctr"
    # Minimum impressions before counting outcome
    min_impressions: 100
    # Secondary metrics to track
    secondary_metrics:
      - conversion_rate
      - cost_per_click

  landing_page:
    primary_metric: "conversion_rate"
    min_visits: 50
    secondary_metrics:
      - bounce_rate
      - time_on_page
      - scroll_depth

  interview_question:
    primary_metric: "response_quality_score"
    min_responses: 10
    secondary_metrics:
      - completion_rate
      - insight_density

  pricing_test:
    primary_metric: "revenue_per_visitor"
    min_visitors: 100
    secondary_metrics:
      - conversion_rate
      - average_order_value

# UCB algorithm parameters
ucb:
  # Confidence level for UCB bounds
  confidence_level: 0.95

  # Decay factor for older observations (1.0 = no decay)
  time_decay_factor: 0.99

  # Window size for recent-only calculations (0 = all history)
  observation_window_days: 30

# Offline evaluation settings
offline_evaluation:
  # How often to run offline evaluation (hours)
  evaluation_interval_hours: 24

  # Minimum sample size for evaluation report
  min_samples_per_policy: 50

  # Alert if policy underperforms by this margin
  underperformance_threshold: 0.1

  # Statistical significance level
  significance_level: 0.05
