# OnboardingCrew Task Definitions
# Phase 0: Transform Founder's raw idea into structured Founder's Brief
#
# Two-Layer Architecture:
# - Layer 1: "Alex" chat (Vercel AI SDK in product app) conducts conversational interview
# - Layer 2: This crew validates and compiles the Founder's Brief

analyze_interview_gaps:
  description: >
    Analyze the conversation transcript from the "Alex" interview to identify gaps
    in the 7 interview stages. "Alex" is the AI chat assistant in the product app
    that already conducted the conversational interview - your job is to review
    the transcript and determine if it's complete enough to proceed.

    CONVERSATION TRANSCRIPT (from Alex chat):
    {conversation_transcript}

    EXTRACTED DATA (summary from Alex):
    {entrepreneur_input}

    USER TYPE: {user_type}

    Review each of the 7 stages for completeness:

    1. VISION: Is the core idea clearly articulated? Is there a one-liner version?

    2. PROBLEM: Is the problem statement specific? Is it validated by examples?

    3. CUSTOMER: Is the target customer segment defined? Are characteristics clear?

    4. SOLUTION: Are proposed solutions described? Are key features identified?

    5. MARKET: Is market context provided? Are competitors mentioned?

    6. TRACTION: Is current progress or validation documented? What's been tried?

    7. GOALS: Are validation goals clear? What does success look like?

    For each gap found, provide:
    - Which stage has the gap
    - What specific information is missing
    - A suggested follow-up question to fill the gap
  expected_output: >
    A gap analysis report in JSON format:
    {
      "completeness_score": 0-100,
      "gaps_identified": [
        {
          "stage": "PROBLEM | CUSTOMER | etc.",
          "missing_info": "What's missing",
          "follow_up_question": "Suggested question to ask"
        }
      ],
      "recommendation": "COMPLETE | NEEDS_FOLLOWUP",
      "analysis_summary": "Brief summary of transcript quality"
    }

    Mark as COMPLETE if score >= 70 and no critical gaps in PROBLEM, CUSTOMER, or SOLUTION.
    Mark as NEEDS_FOLLOWUP if score < 70 or critical gaps exist.
  agent: o1_interview_gap_analyzer

validate_concept_legitimacy:
  description: >
    Review the interview output and validate that the business concept is legitimate.
    Apply rigorous screening criteria:

    LEGAL CHECK:
    - Not involved in illegal goods/services (drugs, weapons, trafficking)
    - Not facilitating fraud or financial crimes
    - Not violating intellectual property laws
    - Not circumventing regulations (securities, healthcare, etc.)
    - Compliant with major jurisdiction laws (US, EU)

    ETHICAL CHECK:
    - Not exploiting vulnerable populations
    - Not causing environmental harm
    - Not enabling harassment or discrimination
    - Not spreading misinformation
    - Transparent about what it does

    FEASIBILITY CHECK:
    - Not requiring technology that doesn't exist
    - Not violating laws of physics
    - Not requiring impossible resources
    - Has some plausible path to execution

    BUSINESS SANITY CHECK:
    - Has identifiable potential customers
    - Solves a problem someone might have
    - Has some conceivable revenue model
    - Not already tried and failed catastrophically

    Review the gap analysis output from the previous task (analyze_interview_gaps)
    along with the conversation transcript to validate the business concept's legitimacy.
  expected_output: >
    A legitimacy report in JSON format:
    {
      "legitimacy_status": "PASS | FAIL | NEEDS_REVIEW",
      "legal_check": {"status": "PASS|FAIL", "flags": [], "notes": ""},
      "ethical_check": {"status": "PASS|FAIL", "flags": [], "notes": ""},
      "feasibility_check": {"status": "PASS|FAIL", "flags": [], "notes": ""},
      "business_sanity_check": {"status": "PASS|FAIL", "flags": [], "notes": ""},
      "overall_recommendation": "Summary of why concept should/shouldn't proceed",
      "concerns_to_address": ["List of specific concerns if any"]
    }
  agent: gv1_concept_validator
  context:
    - analyze_interview_gaps

verify_intent_capture:
  description: >
    Compare the interview output with the founder's original input to verify
    that their intent was captured correctly. Check for:

    COMPLETENESS:
    - Were all 7 interview areas covered?
    - Is the customer hypothesis captured?
    - Is the problem hypothesis captured?
    - Is the solution hypothesis captured?
    - Are key assumptions identified?
    - Are success criteria defined?

    ACCURACY:
    - Does the summary reflect what was said?
    - Are there words put in the founder's mouth?
    - Are nuances preserved?
    - Is the enthusiasm level captured?

    CLARITY:
    - Are ambiguous terms clarified?
    - Is industry jargon explained?
    - Is the scope clearly bounded?
    - Is the target market defined?

    CONSISTENCY:
    - Do customer and problem align?
    - Does the solution address the stated problem?
    - Are success criteria measurable?
    - Are assumptions testable?

    Review the gap analysis output from the previous task (analyze_interview_gaps)
    along with the conversation transcript to verify the founder's intent was captured accurately.
  expected_output: >
    An intent verification report:
    {
      "verification_status": "PASS | FAIL | NEEDS_FOLLOWUP",
      "completeness": {"status": "PASS|FAIL", "gaps": []},
      "accuracy": {"status": "PASS|FAIL", "issues": []},
      "clarity": {"status": "PASS|FAIL", "ambiguities": []},
      "consistency": {"status": "PASS|FAIL", "contradictions": []},
      "followup_questions": ["List of questions if status is NEEDS_FOLLOWUP"],
      "overall_assessment": "Summary of verification findings"
    }
  agent: gv2_intent_verification
  context:
    - analyze_interview_gaps

compile_founders_brief:
  description: >
    Synthesize all inputs (interview output, legitimacy report, intent verification)
    into a complete, structured Founder's Brief. This is the PRIME ARTIFACT that
    will guide all downstream validation work.

    The Founder's Brief must include:

    1. THE IDEA
       - one_liner: Single sentence description
       - description: Full explanation
       - inspiration: What motivated this idea
       - unique_insight: What the founder sees that others don't

    2. PROBLEM HYPOTHESIS (marked as HYPOTHESIS - NOT VALIDATED)
       - problem_statement: Clear articulation of the problem
       - who_has_this_problem: Target customer description
       - frequency: How often they face this problem
       - current_alternatives: How they solve it today
       - why_alternatives_fail: Pain points with current solutions

    3. CUSTOMER HYPOTHESIS (marked as HYPOTHESIS - NOT VALIDATED)
       - primary_segment: Who this is for
       - segment_description: Detailed characteristics
       - where_to_find_them: Acquisition channels

    4. SOLUTION HYPOTHESIS (marked as HYPOTHESIS - NOT VALIDATED)
       - proposed_solution: How it works
       - key_features: Top 2-3 features
       - differentiation: What makes it different

    5. KEY ASSUMPTIONS (ranked by risk)
       - List each assumption with: category, risk_level, how_to_test

    6. SUCCESS CRITERIA
       - minimum_viable_signal: What "validated" looks like
       - deal_breakers: What would kill the idea
       - target_metrics: Quantitative goals

    7. FOUNDER CONTEXT
       - background: Relevant experience
       - motivation: Why they're doing this
       - time_commitment: Full-time, part-time, exploring
       - resources_available: What they can invest

    8. QA STATUS
       - legitimacy_check: From GV1
       - intent_verification: From GV2
       - overall_status: APPROVED, REJECTED, or PENDING

    Use the outputs from the previous tasks in the context:
    - Gap analysis from analyze_interview_gaps
    - Legitimacy report from validate_concept_legitimacy
    - Intent verification from verify_intent_capture
  expected_output: >
    A complete Founder's Brief as a structured JSON document ready for human
    approval at the approve_founders_brief HITL checkpoint. The brief should be:
    - Complete: All sections filled out
    - Accurate: Reflects founder's actual intent
    - Actionable: Clear enough to guide Phase 1 validation
    - Honest: Hypotheses clearly marked as unvalidated
  agent: s1_brief_compiler
  context:
    - analyze_interview_gaps
    - validate_concept_legitimacy
    - verify_intent_capture
